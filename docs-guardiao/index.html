<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>O GuardiÃ£o do Sono - ExperiÃªncia TerapÃªutica 3D</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Tela de boas-vindas -->
    <div id="welcome-screen" class="screen active">
        <div class="welcome-content">
            <h1 class="title-glow">ğŸŒ™ O GuardiÃ£o do Sono</h1>
            <p class="subtitle">Uma jornada terapÃªutica de 10 minutos para relaxamento profundo</p>
            
            <div class="instructions">
                <h3>Prepare-se:</h3>
                <ul>
                    <li>ğŸ›ï¸ Deite-se confortavelmente</li>
                    <li>ğŸ§ Use fones de ouvido</li>
                    <li>ğŸŒ‘ Reduza a iluminaÃ§Ã£o do ambiente</li>
                    <li>ğŸ˜Œ Respire profundamente</li>
                </ul>
            </div>

            <!-- Seletor de voz -->
            <div class="voice-selector">
                <h3>ğŸ¤ Qualidade da Voz:</h3>
                <div class="voice-options">
                    <button class="voice-option" data-voice="webspeech">
                        <span class="option-icon">ğŸ”Š</span>
                        <span class="option-name">Voz SintÃ©tica</span>
                        <span class="option-desc">GrÃ¡tis â€¢ Offline</span>
                    </button>
                    <button class="voice-option" data-voice="google">
                        <span class="option-icon">ğŸŒ</span>
                        <span class="option-name">Google TTS</span>
                        <span class="option-desc">Natural â€¢ Requer API</span>
                    </button>
                    <button class="voice-option active" data-voice="elevenlabs">
                        <span class="option-icon">âœ¨</span>
                        <span class="option-name">ElevenLabs</span>
                        <span class="option-desc">Ultra Realista PT-BR ğŸ‡§ğŸ‡· â€¢ PadrÃ£o</span>
                    </button>
                </div>
                <div class="voice-buttons">
                    <button id="test-voice-button" class="small-button test-button">ğŸµ Testar Voz</button>
                    <button id="config-api-button" class="small-button" style="display: none;">âš™ï¸ Configurar APIs</button>
                </div>
                <p style="font-size: 0.85em; color: #aaa; margin-top: 8px;">
                    ğŸ‡§ğŸ‡· Voz Lotte (PT-BR) configurada â€¢ Uso familiar
                </p>
            </div>

            <div id="voice-status" style="margin: 15px 0; padding: 12px; background: rgba(76, 175, 80, 0.2); border-radius: 8px; border-left: 4px solid #4caf50;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 24px;">âœ¨</span>
                    <div>
                        <div style="font-weight: bold; color: #4caf50;">ElevenLabs Ativo</div>
                        <div style="font-size: 0.85em; color: #aaa;">Voz Lotte (PT-BR) â€¢ Ultra-realista</div>
                    </div>
                </div>
            </div>

            <button id="start-button" class="glow-button">
                Iniciar Jornada
            </button>
            
            <button id="test-audio-button" class="test-audio-button">
                ğŸ”Š Testar Som Completo (Debug)
            </button>
            
            <button id="list-voices-button" class="test-audio-button" style="background: #1976d2;">
                ğŸ¤ Listar Todas as Vozes (Debug)
            </button>
            
            <button id="download-test-button" class="test-audio-button" style="background: #e91e63;">
                ğŸ’¾ Baixar Ãudio ElevenLabs (Teste Puro)
            </button>

            <p class="disclaimer">
                âš ï¸ Este jogo Ã© um complemento relaxante e nÃ£o substitui tratamento mÃ©dico ou terapÃªutico.
            </p>
        </div>
    </div>

    <!-- Canvas 3D -->
    <canvas id="game-canvas"></canvas>

    <!-- HUD overlay -->
    <div id="hud-overlay">
        <div id="phase-indicator" class="fade-text"></div>
        <div id="narration-text" class="narration"></div>
        <div id="breath-indicator" class="breath-circle"></div>
    </div>

    <!-- Tela de finalizaÃ§Ã£o -->
    <div id="end-screen" class="screen">
        <div class="end-content">
            <h2 class="title-glow">âœ¨ Agora, seu corpo sabe o caminho do descanso.</h2>
            <p class="subtitle">Permita-se adormecer tranquilamente...</p>
            
            <div class="sleep-timer">
                <p>O som continuarÃ¡ por mais alguns minutos para facilitar sua transiÃ§Ã£o para o sono.</p>
            </div>

            <button id="restart-button" class="glow-button">
                Reiniciar ExperiÃªncia
            </button>
        </div>
    </div>

    <!-- Loading indicator -->
    <div id="loading-screen" class="screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>Preparando sua jornada...</p>
        </div>
    </div>

    <!-- Tela de configuraÃ§Ã£o de API -->
    <div id="api-config-screen" class="screen">
        <div class="api-config-content">
            <h2>âš™ï¸ ConfiguraÃ§Ã£o de APIs de Voz</h2>
            <p class="api-subtitle">Para usar vozes premium, vocÃª precisa de API keys gratuitas ou pagas.</p>
            
            <div class="api-section">
                <h3>ğŸŒ Google Cloud Text-to-Speech</h3>
                <p>Vozes naturais do Google. <a href="https://cloud.google.com/text-to-speech" target="_blank">Obter API Key</a></p>
                <input type="text" id="google-api-key" placeholder="Cole sua API key aqui" class="api-input">
                <p class="api-note">ğŸ’° GrÃ¡tis atÃ© 4 milhÃµes de caracteres/mÃªs</p>
            </div>

            <div class="api-section">
                <h3>âœ¨ ElevenLabs (PortuguÃªs do Brasil)</h3>
                <p>Vozes ultra-realistas com IA. <a href="https://elevenlabs.io" target="_blank">Obter API Key</a></p>
                <input type="text" id="elevenlabs-api-key" placeholder="Cole sua API key aqui" class="api-input">
                <p class="api-note">ğŸ’° 10.000 caracteres grÃ¡tis/mÃªs (conta gratuita)</p>
                
                <div class="voice-info">
                    <p><strong>ğŸ‡§ğŸ‡· Voz PadrÃ£o:</strong> <em>Lotte</em> - Feminina, suave e terapÃªutica</p>
                    <details style="margin-top: 8px;">
                        <summary style="cursor: pointer; color: #64b5f6;">Ver outras vozes brasileiras disponÃ­veis</summary>
                        <ul style="margin-top: 8px; font-size: 0.9em; color: #aaa;">
                            <li>ğŸ¤ <strong>Valentina</strong> - Feminina, jovem, energÃ©tica</li>
                            <li>ğŸ¤ <strong>Giovanni</strong> - Masculino, profundo, autoritÃ¡rio</li>
                            <li>ğŸ¤ <strong>Marcus</strong> - Masculino, maduro, confiante</li>
                        </ul>
                        <p style="margin-top: 8px; font-size: 0.85em; color: #888;">
                            Para trocar a voz, edite o arquivo <code>js/voice-system.js</code> (linha 27)
                        </p>
                    </details>
                </div>
            </div>

            <div class="api-buttons">
                <button id="save-api-keys" class="glow-button">Salvar ConfiguraÃ§Ãµes</button>
                <button id="close-api-config" class="secondary-button">Voltar</button>
            </div>

            <div class="api-help">
                <h4>â“ Como obter API keys:</h4>
                <ol>
                    <li><strong>Google TTS:</strong> Crie conta no Google Cloud â†’ Ative Text-to-Speech API â†’ Copie a key</li>
                    <li><strong>ElevenLabs:</strong> Crie conta gratuita â†’ VÃ¡ em Profile â†’ Copie a API key</li>
                </ol>
                <p class="api-privacy">ğŸ”’ Suas keys sÃ£o salvas apenas no seu navegador (localStorage)</p>
            </div>
        </div>
    </div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Scripts do jogo -->
    <script src="js/voice-system.js"></script>
    <script src="js/audio-system.js"></script>
    <script src="js/binaural-beats.js"></script>
    <script src="js/phase-transition.js"></script>
    <script src="js/phase-1-sunset.js"></script>
    <script src="js/phase-2-underwater.js"></script>
    <script src="js/phase-3-guardian.js"></script>
    <script src="js/main.js"></script>
    <script src="js/voice-ui.js"></script>
</body>
</html>
